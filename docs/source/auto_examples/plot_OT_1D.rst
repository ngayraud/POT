

.. _sphx_glr_auto_examples_plot_OT_1D.py:


====================
1D optimal transport
====================

@author: rflamary




.. rst-class:: sphx-glr-horizontal


    *

      .. image:: /auto_examples/images/sphx_glr_plot_OT_1D_001.png
            :scale: 47

    *

      .. image:: /auto_examples/images/sphx_glr_plot_OT_1D_002.png
            :scale: 47

    *

      .. image:: /auto_examples/images/sphx_glr_plot_OT_1D_003.png
            :scale: 47

    *

      .. image:: /auto_examples/images/sphx_glr_plot_OT_1D_004.png
            :scale: 47


.. rst-class:: sphx-glr-script-out

 Out::

    It.  |Err         
    -------------------
        0|8.187970e-02|
       10|3.460174e-02|
       20|6.633335e-03|
       30|9.797798e-04|
       40|1.389606e-04|
       50|1.959016e-05|
       60|2.759079e-06|
       70|3.885166e-07|
       80|5.470605e-08|
       90|7.702918e-09|
      100|1.084609e-09|
      110|1.527180e-10|




|


.. code-block:: python


    import numpy as np
    import matplotlib.pylab as pl
    import ot
    from ot.datasets import get_1D_gauss as gauss


    #%% parameters

    n=100 # nb bins

    # bin positions
    x=np.arange(n,dtype=np.float64)

    # Gaussian distributions
    a=gauss(n,m=20,s=5) # m= mean, s= std
    b=gauss(n,m=60,s=10)

    # loss matrix
    M=ot.dist(x.reshape((n,1)),x.reshape((n,1)))
    M/=M.max()

    #%% plot the distributions

    pl.figure(1)
    pl.plot(x,a,'b',label='Source distribution')
    pl.plot(x,b,'r',label='Target distribution')
    pl.legend()

    #%% plot distributions and loss matrix

    pl.figure(2)
    ot.plot.plot1D_mat(a,b,M,'Cost matrix M')

    #%% EMD

    G0=ot.emd(a,b,M)

    pl.figure(3)
    ot.plot.plot1D_mat(a,b,G0,'OT matrix G0')

    #%% Sinkhorn

    lambd=1e-3
    Gs=ot.sinkhorn(a,b,M,lambd,verbose=True)

    pl.figure(4)
    ot.plot.plot1D_mat(a,b,Gs,'OT matrix Sinkhorn')

**Total running time of the script:** ( 0 minutes  0.674 seconds)



.. container:: sphx-glr-footer


  .. container:: sphx-glr-download

     :download:`Download Python source code: plot_OT_1D.py <plot_OT_1D.py>`



  .. container:: sphx-glr-download

     :download:`Download Jupyter notebook: plot_OT_1D.ipynb <plot_OT_1D.ipynb>`

.. rst-class:: sphx-glr-signature

    `Generated by Sphinx-Gallery <http://sphinx-gallery.readthedocs.io>`_
